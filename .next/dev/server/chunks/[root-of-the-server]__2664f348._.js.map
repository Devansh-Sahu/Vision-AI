{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Vision-AI/app/api/checkout/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\r\nimport Stripe from \"stripe\"\r\n\r\nconst stripe = new Stripe(process.env.STRIPE_SECRET_KEY!, {\r\n    apiVersion: '2024-12-18.acacia' as any, // type cast to avoid future version errors\r\n})\r\n\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const { priceId } = await req.json()\r\n\r\n        // Map frontend IDs to Ad-Hoc Price Data for Test Mode\r\n        const PRICE_MAP: Record<string, any> = {\r\n            \"price_1SdZM5FukbsOAJbKPtMJgZtH\": { unit_amount: 500, product_data: { name: \"Vision-AI Pro (Monthly)\" }, recurring: { interval: \"month\" } },\r\n            \"price_1SdZM5FukbsOAJbKNmlxe4A3\": { unit_amount: 5000, product_data: { name: \"Vision-AI Pro (Yearly)\" }, recurring: { interval: \"year\" } },\r\n            \"price_1SdZMTFukbsOAJbKxCe0z2KE\": { unit_amount: 2000, product_data: { name: \"Vision-AI Enterprise (Monthly)\" }, recurring: { interval: \"month\" } },\r\n            \"price_1SdZMnFukbsOAJbKig3R1of5\": { unit_amount: 20000, product_data: { name: \"Vision-AI Enterprise (Yearly)\" }, recurring: { interval: \"year\" } }\r\n        };\r\n\r\n        const adHoc = PRICE_MAP[priceId];\r\n        const line_item = adHoc\r\n            ? { price_data: { currency: 'usd', ...adHoc }, quantity: 1 }\r\n            : { price: priceId, quantity: 1 };\r\n\r\n        const session = await stripe.checkout.sessions.create({\r\n            mode: \"subscription\",\r\n            payment_method_types: [\"card\"],\r\n            line_items: [line_item],\r\n            success_url: `${process.env.NEXT_PUBLIC_SITE_URL}/dashboard?success=true`,\r\n            cancel_url: `${process.env.NEXT_PUBLIC_SITE_URL}/?canceled=true`,\r\n        })\r\n\r\n        return NextResponse.json({ url: session.url })\r\n    } catch (err: any) {\r\n        console.error(\"Stripe error:\", err)\r\n        return NextResponse.json({ error: err.message }, { status: 500 })\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,SAAS,IAAI,mKAAM,CAAC,QAAQ,GAAG,CAAC,iBAAiB,EAAG;IACtD,YAAY;AAChB;AAEO,eAAe,KAAK,GAAY;IACnC,IAAI;QACA,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;QAElC,sDAAsD;QACtD,MAAM,YAAiC;YACnC,kCAAkC;gBAAE,aAAa;gBAAK,cAAc;oBAAE,MAAM;gBAA0B;gBAAG,WAAW;oBAAE,UAAU;gBAAQ;YAAE;YAC1I,kCAAkC;gBAAE,aAAa;gBAAM,cAAc;oBAAE,MAAM;gBAAyB;gBAAG,WAAW;oBAAE,UAAU;gBAAO;YAAE;YACzI,kCAAkC;gBAAE,aAAa;gBAAM,cAAc;oBAAE,MAAM;gBAAiC;gBAAG,WAAW;oBAAE,UAAU;gBAAQ;YAAE;YAClJ,kCAAkC;gBAAE,aAAa;gBAAO,cAAc;oBAAE,MAAM;gBAAgC;gBAAG,WAAW;oBAAE,UAAU;gBAAO;YAAE;QACrJ;QAEA,MAAM,QAAQ,SAAS,CAAC,QAAQ;QAChC,MAAM,YAAY,QACZ;YAAE,YAAY;gBAAE,UAAU;gBAAO,GAAG,KAAK;YAAC;YAAG,UAAU;QAAE,IACzD;YAAE,OAAO;YAAS,UAAU;QAAE;QAEpC,MAAM,UAAU,MAAM,OAAO,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC;YAClD,MAAM;YACN,sBAAsB;gBAAC;aAAO;YAC9B,YAAY;gBAAC;aAAU;YACvB,aAAa,6DAAoC,uBAAuB,CAAC;YACzE,YAAY,6DAAoC,eAAe,CAAC;QACpE;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,KAAK,QAAQ,GAAG;QAAC;IAChD,EAAE,OAAO,KAAU;QACf,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,IAAI,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;AACJ"}}]
}