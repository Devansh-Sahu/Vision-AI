module.exports=[291020,a=>{"use strict";var b=a.i(187924);a.i(708720);var c=a.i(409e3);let d=(0,a.i(269240).createClient)();async function e(){let{data:a,error:b}=await d.auth.getUser();return b?(console.error("Supabase getUser error",b),null):a.user?.id??null}async function f(a){let b=await e();if(!b)return;let{error:c}=await d.from("drowsiness_events").insert({user_id:b,organization_id:null,alertness_score:a.alertnessScore,eye_aspect_ratio:a.ear,blink_frequency:a.blinkFrequency,triggered_alert:a.triggeredAlert,alert_type:null,emergency_contact:null,session_id:a.sessionId});c&&console.error("logDrowsinessEvent error",c)}async function g(a,b){if(!a.length)return;let c=await e();if(!c)return;let f=a.map(a=>({user_id:c,organization_id:null,object_class:a.objectClass,confidence:a.confidence,severity_level:a.severity,bbox:a.bbox,frame_source:"webcam",frame_url:null,location_lat:null,location_lng:null,highway_name:null,session_id:b})),{error:g}=await d.from("hazard_detections").insert(f);g&&console.error("logHazardEvents error",g)}async function h(){let a=await e();if(!a)return null;let{data:b,error:c}=await d.from("vase_sessions").insert({user_id:a,organization_id:null,start_time:new Date().toISOString(),total_alerts:0,hazards_detected:0,emergency_contact_notified:!1}).select("id").single();return c?(console.error("startVaseSession error",c),null):b?.id??null}async function i(a){if(!a.sessionId)return;let b=new Date,c=a.startTime?Math.round((b.getTime()-a.startTime.getTime())/1e3):null,{error:e}=await d.from("vase_sessions").update({end_time:b.toISOString(),duration_seconds:c,total_alerts:a.totalAlerts,average_alertness:a.averageAlertness,hazards_detected:a.hazardsDetected,emergency_contact_notified:a.emergencyContactNotified}).eq("id",a.sessionId);e&&console.error("endVaseSession error",e)}async function j(a){let b,c=await e();if(!c)return console.warn("Cannot save contact: No user logged in"),null;let{data:f}=await d.from("emergency_contacts").select("id").eq("user_id",c).limit(1).single();if(b=f?(await d.from("emergency_contacts").update({name:"VASE Emergency Contact",phone:a,updated_at:new Date().toISOString()}).eq("id",f.id)).error:(await d.from("emergency_contacts").insert({user_id:c,name:"VASE Emergency Contact",phone:a,is_primary:!0,notify_on_hazard:!0,notify_on_drowsiness:!0})).error)throw console.error("saveEmergencyContact error details:",JSON.stringify(b,null,2)),Error(`Supabase Error: ${b.message||JSON.stringify(b)}`);return!0}async function k(){let a=await e();if(!a)return null;let{data:b,error:c}=await d.from("emergency_contacts").select("*").eq("user_id",a).limit(1).single();return c?("PGRST116"!==c.code&&console.error("getEmergencyContact error",c),null):b.phone||null}var l=a.i(572131),m=a.i(346271),n=a.i(340695),o=a.i(262036),p=a.i(73570);function q({type:a,message:c,onClose:d}){return((0,l.useEffect)(()=>{let a=setTimeout(()=>{d()},5e3);return()=>clearTimeout(a)},[d]),a)?(0,b.jsx)(o.AnimatePresence,{children:(0,b.jsxs)(m.motion.div,{initial:{x:"100%",opacity:0},animate:{x:0,opacity:1},exit:{x:"100%",opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-6 right-6 z-50 max-w-sm w-full bg-red-600 text-white p-4 rounded-lg shadow-lg flex items-start space-x-3",children:[(0,b.jsx)(p.AlertTriangle,{className:"h-6 w-6 text-white flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-medium",children:"hazard"===a?"Hazard Detected!":"Drowsiness Detected!"}),(0,b.jsx)("p",{className:"text-sm opacity-90",children:c})]}),(0,b.jsx)("button",{onClick:d,className:"text-white opacity-70 hover:opacity-100 transition-opacity","aria-label":"Close alert",children:"✕"})]})}):null}var r=a.i(703130),s=a.i(280281),t=a.i(917171),u=a.i(205522),v=a.i(254161),w=a.i(602150),x=a.i(897942),y=a.i(422262),z=a.i(497895);function A({...a}){return(0,b.jsx)(x.Root,{"data-slot":"dialog",...a})}function B({...a}){return(0,b.jsx)(x.Portal,{"data-slot":"dialog-portal",...a})}function C({className:a,...c}){return(0,b.jsx)(x.Overlay,{"data-slot":"dialog-overlay",className:(0,z.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...c})}function D({className:a,children:c,showCloseButton:d=!0,...e}){return(0,b.jsxs)(B,{"data-slot":"dialog-portal",children:[(0,b.jsx)(C,{}),(0,b.jsxs)(x.Content,{"data-slot":"dialog-content",className:(0,z.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...e,children:[c,d&&(0,b.jsxs)(x.Close,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,b.jsx)(y.XIcon,{}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function E({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"dialog-header",className:(0,z.cn)("flex flex-col gap-2 text-center sm:text-left",a),...c})}function F({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"dialog-footer",className:(0,z.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...c})}function G({className:a,...c}){return(0,b.jsx)(x.Title,{"data-slot":"dialog-title",className:(0,z.cn)("text-lg leading-none font-semibold",a),...c})}function H({className:a,...c}){return(0,b.jsx)(x.Description,{"data-slot":"dialog-description",className:(0,z.cn)("text-muted-foreground text-sm",a),...c})}var I=a.i(177156),J=a.i(64791),K=a.i(355707),L=a.i(212439),M=a.i(252920),N=a.i(400210),O=a.i(603314),P=a.i(523312),Q=a.i(713513),R=a.i(297651),S=a.i(238246),T=a.i(332150),U=a.i(181977);let V={cow:"Cow",dog:"Dog",buffalo:"Buffalo",pothole:"Pothole",debris:"Debris",pedestrian:"Pedestrian",broken_vehicle:"Broken Vehicle",fallen_tree:"Fallen Tree",vehicle:"Vehicle",animal:"Animal",animal_large:"Large Animal",bear:"Bear",cat:"Cat",horse:"Horse"};function W(){let a=(0,l.useRef)(null),d=(0,l.useRef)(null),e=(0,l.useRef)(null),o=(0,l.useRef)(null),[x,y]=(0,l.useState)(!1),[z,B]=(0,l.useState)(!1),[C,W]=(0,l.useState)(!1),[X,Y]=(0,l.useState)({type:null,message:""}),[Z,$]=(0,l.useState)(!0),[_,aa]=(0,l.useState)(""),[ab,ac]=(0,l.useState)(null),[ad,ae]=(0,l.useState)([]),[af,ag]=(0,l.useState)({overallStatus:"safe",riskScore:0,alertnessRisk:0,hazardRisk:0,timestamp:Date.now(),shouldAlert:!1,alertMessage:null}),[ah,ai]=(0,l.useState)(()=>(0,U.createAlertnessWindow)()),[aj,ak]=(0,l.useState)([]),al=(0,l.useRef)(null),am=(0,l.useRef)(null),an=(0,l.useRef)(null),ao=(0,l.useRef)(0),ap=(0,l.useRef)(0),aq=(0,l.useRef)(0),ar=(0,l.useRef)(0),as=(0,l.useRef)(0);(0,l.useEffect)(()=>{k().then(a=>{a&&aa(a)})},[]);let at=async()=>{if(!_||!_.includes("@"))return void window.alert("Please enter a valid email.");try{await j(_),window.alert(`Emergency contact saved to Supabase: ${_}`)}catch(a){console.error(a),window.alert("Failed to save contact. See console.")}},[au,av]=(0,l.useState)(!1);async function aw(){let a=(await navigator.mediaDevices.enumerateDevices()).filter(a=>"videoinput"===a.kind);return{frontCam:a.find(a=>a.label.toLowerCase().includes("integrated"))||a[0],rearCam:a.find(a=>a.label.toLowerCase().includes("iriun")||a.label.toLowerCase().includes("droid"))}}(0,l.useEffect)(()=>{av(!0)},[]);let ax=(0,l.useCallback)(async()=>{let b=null;if(x&&a.current)try{let d=await (0,c.runRealDrowsinessDetection)(a.current);if(d){b=d,ac(d);let a=(0,U.updateAlertnessWindow)(ah,d.alertnessScore);ai(a)}}catch(a){console.error("Real drowsiness detection error:",a)}else b=ab;let e=[];if(z&&d.current)try{e=await (0,c.runRealHazardDetection)(d.current),ae(e)}catch(a){console.error("Real hazard detection error:",a),e=[]}else e=[],ae([]);let h=ah.average,i=(0,U.assessRisk)(b,e,h);if(ag(i),b&&(aq.current+=b.alertnessScore,ar.current+=1),ap.current+=e.length,b&&f({alertnessScore:b.alertnessScore,ear:b.eyeAspectRatio,blinkFrequency:b.blinkFrequency,triggeredAlert:i.shouldAlert,sessionId:an.current}),e.length>0&&g(e,an.current),i.shouldAlert){ao.current+=1;let a=null,d="";if("high-risk"===i.overallStatus||i.hazardRisk>50){a="hazard";let b=Array.from(new Set(e.map(a=>V[a.objectClass]||a.objectClass)));d=`HAZARD: ${b.join(", ")}`}else b&&b.alertnessScore<60&&(a="drowsiness",d=`DROWSINESS: Alertness ${b.alertnessScore}%`);if(a){let f=Date.now();if(X.type!==a||X.message!==d||f-as.current>2e3){(0,c.triggerAlert)(a),Y({type:a,message:d}),as.current=f;let b=aj[aj.length-1];(!b||b.message!==d||f-b.time.getTime()>5e3)&&ak(a=>[...a.slice(-9),{time:new Date,message:d,status:i.overallStatus}])}let g=["cow","buffalo","deer","bear","fallen_tree","pothole","wrong_way_vehicle"],h=e.some(a=>g.includes(a.objectClass)),j=b&&b.alertnessScore<30;if((h||j)&&_){let b=localStorage.getItem("last_emergency_email"),c=Date.now();(!b||c-parseInt(b)>6e4)&&(console.log("Triggering Emergency Email to:",_),localStorage.setItem("last_emergency_email",c.toString()),fetch("/api/email-alert",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:_,subject:`URGENT: Vision-AI ${a?.toUpperCase()} Alert`,message:`Vision-AI detected a critical safety event.

Type: ${a}
Details: ${d}
Time: ${new Date().toLocaleString()}

Please check on the driver immediately.`})}).catch(a=>console.error("Failed to send email:",a)))}}}else X.type&&Date.now()-as.current>2e3&&Y({type:null,message:""});ay(e)},[x,z,ah,ab,X,Z,_,aj]),ay=a=>{let b=o.current,c=d.current;if(!b||!c)return;let e=b.getContext("2d");e&&(b.width=c.videoWidth||640,b.height=c.videoHeight||480,e.clearRect(0,0,b.width,b.height),a.forEach(a=>{let c=a.bbox.x*b.width,d=a.bbox.y*b.height,f=a.bbox.width*b.width,g=a.bbox.height*b.height;e.strokeStyle=({critical:"#ef4444",high:"#f59e0b",medium:"#06b6d4",low:"#22c55e"})[a.severity],e.lineWidth=3,e.strokeRect(c,d,f,g);let h=`${V[a.objectClass]||a.objectClass} ${Math.round(100*a.confidence)}%`;e.fillStyle=e.strokeStyle;let i=e.measureText(h).width;e.fillRect(c,d-24,i+12,24),e.fillStyle="#fff",e.font="14px sans-serif",e.fillText(h,c+6,d-7)}))},az=async()=>{if(x){let b=a.current?.srcObject;b?.getTracks().forEach(a=>a.stop()),a.current&&(a.current.srcObject=null),y(!1);return}try{let{frontCam:b}=await aw();if(!b)return void console.error("No front (laptop) camera found");let c=await navigator.mediaDevices.getUserMedia({video:{deviceId:b.deviceId,width:640,height:480}});a.current&&(a.current.srcObject=c,await a.current.play(),y(!0),am.current||(am.current=new Date))}catch(a){console.error("Front camera access failed:",a)}},aA=async()=>{if(z){let a=d.current?.srcObject;a?.getTracks().forEach(a=>a.stop()),d.current&&(d.current.srcObject=null),B(!1);return}try{let{rearCam:a}=await aw();if(!a)return void console.error("No phone (rear) camera found. Is DroidCam/Iriun running?");let b=await navigator.mediaDevices.getUserMedia({video:{deviceId:a.deviceId,width:1280,height:720}});d.current&&(d.current.srcObject=b,await d.current.play(),B(!0),ae([]),am.current||(am.current=new Date))}catch(a){console.error("Rear camera access failed:",a)}};(0,l.useEffect)(()=>{if(!C)return;let a=!0;return(async()=>{for(;a&&C;)await ax(),await new Promise(a=>setTimeout(a,500))})(),()=>{a=!1}},[C,ax]),(0,l.useEffect)(()=>{let a=setInterval(()=>{let a=(0,c.getCurrentAlert)();a?Y({type:a,message:"hazard"===a?"Potential hazard detected.":"Drowsiness detected."}):Y({type:null,message:""})},1e3);return()=>clearInterval(a)},[]),(0,l.useEffect)(()=>{},[]);let aB=(a=>{switch(a){case"safe":return{label:"SAFE",bg:"bg-success",text:"text-success"};case"caution":return{label:"CAUTION",bg:"bg-warning",text:"text-warning"};case"high-risk":return{label:"HIGH RISK",bg:"bg-destructive",text:"text-destructive"}}})(af.overallStatus);return(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)(A,{open:au,onOpenChange:av,children:(0,b.jsxs)(D,{className:"sm:max-w-md",children:[(0,b.jsxs)(E,{children:[(0,b.jsx)(G,{children:"Welcome to VASE (Vision-AI Safety Engine)"}),(0,b.jsxs)(H,{className:"pt-2 space-y-2",children:[(0,b.jsxs)("p",{children:["To utilize the ",(0,b.jsx)("strong",{children:"Dual-Vision"})," capabilities effectively, please ensure:"]}),(0,b.jsxs)("ul",{className:"list-disc pl-5 space-y-1",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Front Camera:"})," To monitor driver drowsiness."]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Rear Camera:"})," Connect an external webcam/dashcam or use your phone to monitor the road ahead."]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"This setup allows VASE to detect both internal driver state and external road hazards simultaneously."})]})]}),(0,b.jsxs)(F,{className:"sm:justify-start gap-2",children:[(0,b.jsx)(n.Button,{type:"button",onClick:()=>av(!1),children:"I Understand"}),(0,b.jsx)(n.Button,{type:"button",variant:"secondary",onClick:()=>av(!1),children:"Close"})]})]})}),(0,b.jsx)("audio",{ref:al,preload:"auto",children:(0,b.jsx)("source",{src:"data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2teleU9PT46xvqF0Q0VBetjD2aJtOUJdxN7j4Z2CUUpBfbG8rH1LS0ttyuLx8qqIU0tBfaq6rnlKSEtzz+j2+qqJVEpAf6m5r3pJR0p40O3++q2MVUY8g6y5r31KSEp40vD//7GOVkY7hK66sH5KSUl41PL//7KQWEI4h6+7sYBLSkh41vT//7WSWUE2iLC8soFMS0h41/X//7iTW0E1irC8s4JNTEh52Pb//7qUXEAzjLG9tIROTUd52ff//7yVXkAyi7K+tYVPTkd52vj//76XX0Axi7O/toZQT0Z63Pn//8CYYEA…",type:"audio/wav"})}),(0,b.jsx)(q,{type:X.type,message:X.message,onClose:()=>Y({type:null,message:""})}),(0,b.jsx)("header",{className:"border-b border-border bg-card/50 backdrop-blur sticky top-0 z-40",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)(S.default,{href:"/",className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[(0,b.jsx)(N.ArrowLeft,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Back"})]}),(0,b.jsx)(T.VisionAILogo,{size:"sm"})]}),(0,b.jsxs)(v.Badge,{variant:"secondary",className:"gap-1",children:[(0,b.jsx)(O.Shield,{className:"h-3 w-3"}),"Vision-AI Safety Engine (VASE)"]})]})})}),(0,b.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsx)(m.motion.div,{className:`mb-6 p-4 rounded-xl border ${"high-risk"===af.overallStatus?"border-destructive bg-destructive/10":"caution"===af.overallStatus?"border-warning bg-warning/10":"border-success bg-success/10"}`,animate:af.shouldAlert?{scale:[1,1.02,1]}:{},transition:{duration:.5,repeat:af.shouldAlert?1/0:0},children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:`h-16 w-16 rounded-full flex items-center justify-center ${aB.bg}`,children:(0,b.jsx)(O.Shield,{className:"h-8 w-8 text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:`text-2xl font-bold ${aB.text}`,children:aB.label}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Risk Score: ",af.riskScore,"% | Alertness Risk: ",Math.round(af.alertnessRisk),"% | Hazard Risk: ",af.hazardRisk,"%"]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)(n.Button,{onClick:()=>{if(C){if(an.current){let a=ar.current>0?aq.current/ar.current:null;i({sessionId:an.current,startTime:am.current,totalAlerts:ao.current,averageAlertness:a,hazardsDetected:ap.current,emergencyContactNotified:!1})}an.current=null}else h().then(a=>{an.current=a,ao.current=0,ap.current=0,aq.current=0,ar.current=0});W(!C)},variant:C?"destructive":"default",size:"lg",children:C?"Stop VASE":"Start VASE"})})]})}),(0,b.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,b.jsxs)(r.Card,{children:[(0,b.jsx)(r.CardHeader,{className:"pb-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(I.Eye,{className:"h-5 w-5 text-primary"}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.CardTitle,{children:"Front Camera"}),(0,b.jsx)(r.CardDescription,{children:"Driver Alertness Monitoring"})]})]}),(0,b.jsx)(n.Button,{onClick:az,variant:x?"destructive":"outline",size:"sm",children:x?(0,b.jsx)(K.VideoOff,{className:"h-4 w-4"}):(0,b.jsx)(J.Video,{className:"h-4 w-4"})})]})}),(0,b.jsx)(r.CardContent,{className:"p-0",children:(0,b.jsxs)("div",{className:"relative aspect-video bg-secondary/30",children:[(0,b.jsx)("video",{ref:a,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),(0,b.jsx)("canvas",{ref:e,className:"absolute inset-0 w-full h-full pointer-events-none"}),!x&&(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(I.Eye,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Front camera for drowsiness detection"})]})}),x&&ab&&(0,b.jsxs)("div",{className:"absolute bottom-4 left-4 right-4 bg-background/80 backdrop-blur rounded-lg p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:"Alertness"}),(0,b.jsxs)("span",{className:`text-lg font-bold ${(0,U.getStatusColor)(af.overallStatus)}`,children:[Math.round(ah.average),"%"]})]}),(0,b.jsx)(w.Progress,{value:ah.average,className:"h-2"}),(0,b.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground mt-2",children:[(0,b.jsxs)("span",{children:["EAR: ",ab.eyeAspectRatio.toFixed(3)]}),(0,b.jsxs)("span",{children:[" ",ab.blinkFrequency]})]})]})]})})]}),(0,b.jsxs)(r.Card,{children:[(0,b.jsx)(r.CardHeader,{className:"pb-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(p.AlertTriangle,{className:"h-5 w-5 text-warning"}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.CardTitle,{children:"Rear Camera"}),(0,b.jsx)(r.CardDescription,{children:"Road Hazard Detection"})]})]}),(0,b.jsx)(n.Button,{onClick:aA,variant:z?"destructive":"outline",size:"sm",children:z?(0,b.jsx)(K.VideoOff,{className:"h-4 w-4"}):(0,b.jsx)(Q.Camera,{className:"h-4 w-4"})})]})}),(0,b.jsx)(r.CardContent,{className:"p-0",children:(0,b.jsxs)("div",{className:"relative aspect-video bg-secondary/30",children:[(0,b.jsx)("video",{ref:d,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),(0,b.jsx)("canvas",{ref:o,className:"absolute inset-0 w-full h-full pointer-events-none"}),!z&&(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(Q.Camera,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Rear camera for hazard detection"})]})}),z&&ad.length>0&&(0,b.jsx)("div",{className:"absolute top-4 right-4",children:(0,b.jsxs)(v.Badge,{variant:"destructive",className:"animate-pulse",children:[ad.length," Hazard",ad.length>1?"s":""," Detected"]})})]})})]})]}),(0,b.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6 mt-6",children:[(0,b.jsxs)(r.Card,{children:[(0,b.jsx)(r.CardHeader,{children:(0,b.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(R.Gauge,{className:"h-5 w-5"}),"Unified Risk Meter"]})}),(0,b.jsx)(r.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"relative h-32 flex items-end justify-center",children:(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,b.jsxs)("div",{className:`text-5xl font-bold ${(0,U.getStatusColor)(af.overallStatus)}`,children:[af.riskScore,"%"]})})}),(0,b.jsx)("div",{className:"h-4 rounded-full bg-gradient-to-r from-success via-warning to-destructive overflow-hidden",children:(0,b.jsx)(m.motion.div,{className:"h-full bg-foreground/20",style:{marginLeft:`${af.riskScore}%`},animate:{marginLeft:`${af.riskScore}%`}})}),(0,b.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:"Safe"}),(0,b.jsx)("span",{children:"Caution"}),(0,b.jsx)("span",{children:"High Risk"})]})]})})]}),(0,b.jsxs)(r.Card,{children:[(0,b.jsx)(r.CardHeader,{children:(0,b.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(p.AlertTriangle,{className:"h-5 w-5"}),"Active Hazards"]})}),(0,b.jsx)(r.CardContent,{children:0===ad.length?(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(O.Shield,{className:"h-8 w-8 mx-auto mb-2 opacity-30"}),(0,b.jsx)("p",{className:"text-sm",children:"No hazards detected"})]}):(0,b.jsx)("div",{className:"space-y-2",children:ad.map(a=>(0,b.jsxs)("div",{className:"p-3 rounded-lg bg-warning/10 border border-warning/20",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium",children:V[a.objectClass]||a.objectClass}),(0,b.jsx)(v.Badge,{variant:"critical"===a.severity?"destructive":"secondary",className:"text-xs",children:a.severity})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:["Confidence: ",Math.round(100*a.confidence),"%"]})]},a.id))})})]}),(0,b.jsxs)(r.Card,{children:[(0,b.jsx)(r.CardHeader,{children:(0,b.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(P.Bell,{className:"h-5 w-5"}),"Settings & Alerts"]})}),(0,b.jsxs)(r.CardContent,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[Z?(0,b.jsx)(L.Volume2,{className:"h-4 w-4"}):(0,b.jsx)(M.VolumeX,{className:"h-4 w-4"}),(0,b.jsx)(t.Label,{htmlFor:"sound",children:"Alert Sound"})]}),(0,b.jsx)(s.Switch,{id:"sound",checked:Z,onCheckedChange:$})]}),(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsxs)(t.Label,{htmlFor:"emergency",className:"flex items-center gap-2",children:[(0,b.jsx)(P.Bell,{className:"h-4 w-4"}),"Emergency Contact Email"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(u.Input,{id:"emergency",type:"email",placeholder:"emergency@example.com",value:_,onChange:a=>aa(a.target.value)}),(0,b.jsx)(n.Button,{variant:"outline",onClick:at,children:"Save"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Alerts from Critical Hazards or Drowsiness will prompt an email draft."})]})}),aj.length>0&&(0,b.jsxs)("div",{className:"pt-4 border-t border-border",children:[(0,b.jsx)("div",{className:"text-sm font-medium mb-2",children:"Recent Alerts"}),(0,b.jsx)("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:aj.slice(-5).map((a,c)=>(0,b.jsxs)("div",{className:"text-xs text-muted-foreground flex justify-between",children:[(0,b.jsx)("span",{className:"truncate flex-1 mr-2",children:a.message}),(0,b.jsx)("span",{className:"whitespace-nowrap",children:a.time.toLocaleTimeString()})]},c))})]})]})]})]})]})]})}a.s(["default",()=>W],291020)}];

//# sourceMappingURL=app_dualvision_page_tsx_2f6245ad._.js.map